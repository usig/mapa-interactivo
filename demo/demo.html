<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Demo mapa interactivo</title>
    <style>
      #map {
        height: 500px;
      }
    </style>
</head>
<body>
  <div id="map"></div>
  <div>
    <button onclick="addLayerEstacionamientos()">Capa estacionamientos</button>
    <button onclick="addLayer('centros_de_salud.centros_de_salud_y_accion_comunitaria')">Capa bancos</button>
    <button onclick="addLayer('wifi_gratis')">Capa wifi</button>
    <button onclick="addLayer('red_de_ciclovias')">Capa bici</button>
  </div>
  <div>
    <button onclick="map.removePublicLayer('estacionamiento_en_via_publica')">Remover capa estacionamientos</button>
    <button onclick="map.removePublicLayer('centros_de_salud.centros_de_salud_y_accion_comunitaria')">Remover capa bancos</button>
    <button onclick="map.removePublicLayer('wifi_gratis')">Remover capa wifi</button>
    <button onclick="map.removePublicLayer('red_de_ciclovias')">Remover capa bici</button>
  </div>
</body>
<script src="../lib/MapaInteractivo.js"></script>
<script>
  let map = new MapaInteractivo("map", {
    language: "en",
    attributionControl: true,
    onLayerLoaded: function (layerName, layerId) {console.log (layerName, layerId)},
    onContextMenu: onContextMenu
  });

  function addLayerEstacionamientos() {
    map.addPublicLayer("estacionamiento_en_via_publica", {
      callAPIOnClick: true,
      onClickAPI: "http://epok.buenosaires.gob.ar/atlasvial/buscarInformacionEstacionamiento/?formato=geojson&fullInfo=True&x=$lng&y=$lat&categorias=$categories",
      baseLayer: {
        uri: "http://tiles1.usig.buenosaires.gob.ar/mapcache/tms/1.0.0/estacionamiento_en_via_publica_caba_3857@GoogleMapsCompatible/{z}/{x}/{y}.png"
      }
    });
  }

  function addLayer(id) {
    map.addPublicLayer(id, {clustering: true});
  }
  function onContextMenu(ev) {
    const id = map.addMarker(ev.latlng, true, false, false, false, false, {iconUrl: 'http://static.usig.buenosaires.gob.ar/symbols/bases_extrahospitalarias.png'});
  }

//  setTimeout(() => {
//    map.removePublicLayer("estacionamiento_en_via_publica");
//    map.addPublicLayer("cajeros_automaticos", {clustering: true});
//  }, 10000)
</script>
</html>
